{"version":3,"file":"js/canvas-player.f163a77b.js","mappings":"uPAEA,MAAMA,GAA0B,IAAAC,GAAoB,SAAU,CAC5DC,GAAI,SACJC,MAAO,MACPC,OAAQ,MACRC,MAAO,CACL,OAAU,mBAEX,MAAO,GAGV,OACEC,OAAQ,eACRC,MAAMC,GACJ,MAAMC,GAAY,QAAS,CACzBC,WAAW,EACXC,gBAAgB,EAChBC,QAAS,KACTC,SAAU,KACVC,IAAK,KACLC,UAAW,KACXC,UAAW,OAWb,SAASC,IACP,GAAIR,EAAUG,QAAQM,QAAUT,EAAUG,QAAQO,MAAO,OACzDV,EAAUC,WAAY,EACtB,MAAM,MACJP,EAAK,OACLC,GACEK,EAAUI,SACdJ,EAAUK,IAAIM,UAAU,EAAG,EAAGjB,EAAOC,GACrCK,EAAUK,IAAIO,UAAUZ,EAAUG,QAAS,EAAG,EAAGT,EAAOC,GACxDK,EAAUM,UAAYO,sBAAsBL,EAC9C,CACA,SAASM,IACFd,EAAUG,QAAQM,SACvBT,EAAUG,QAAQY,OAClBP,IACF,CACA,SAASQ,IACHhB,EAAUG,QAAQM,SACtBT,EAAUG,QAAQc,QAClBC,IACF,CACA,SAASA,IACPC,qBAAqBnB,EAAUM,UACjC,CACA,SAASc,IACFpB,EAAUC,YACf,QAAgB,CACdoB,UAAU,EACV3B,MAAO,IACPC,OAAQ,KAEZ,CACA,SAAS2B,IACFtB,EAAUC,YACfsB,QAAQC,IAAIxB,EAAUE,eAAgBF,EAAUO,WAChDP,EAAUE,eAAiBF,EAAUO,UAAUkB,OAASzB,EAAUO,UAAUmB,QAC5E1B,EAAUE,gBAAkBF,EAAUE,eACxC,CACA,OA/CA,SAAU,KACRF,EAAUG,QAAUwB,SAASC,eAAe,SAC5C5B,EAAUI,SAAWuB,SAASC,eAAe,UAC7C5B,EAAUK,IAAML,EAAUI,SAASyB,WAAW,MAC9C7B,EAAUO,UAAY,IAAI,KAAe,CACvCuB,GAAI,UACJT,UAAU,GACV,IAwCG,CAACU,EAAMC,KACZ,MAAMC,EAAuB,KAC7B,OAAO,WAAc,QAAoB,KAAW,KAAM,EAAC,IAAAzC,GAAoB,QAAS,CACtFC,GAAI,QACJyC,IAAK,EACLtC,MAAO,CACL,QAAW,QAEbuC,SAAU,GACVC,MAAO,GACPlB,QAASA,GACR,KAAM,IAAK3B,GAAY,IAAAC,GAAoB,MAAO,KAAM,EAAC,QAAayC,EAAsB,CAC7FI,QAASvB,EACTwB,KAAM,WACL,CACDC,SAAS,SAAS,IAAM,EAAC,QAAiB,SAC1C/C,EAAG,KACD,QAAayC,EAAsB,CACrCI,QAASrB,EACTsB,KAAM,WACL,CACDC,SAAS,SAAS,IAAM,EAAC,QAAiB,SAC1C/C,EAAG,KACD,QAAayC,EAAsB,CACrCI,QAASjB,EACToB,UAAWxC,EAAUC,UACrBqC,KAAM,WACL,CACDC,SAAS,SAAS,IAAM,EAAC,QAAiB,SAC1C/C,EAAG,GACF,EAAG,CAAC,cAAc,QAAayC,EAAsB,CACtDI,QAASf,EACTkB,UAAWxC,EAAUC,UACrBqC,KAAM,WACL,CACDC,SAAS,SAAS,IAAM,EAAC,SAAiB,QAAkBvC,EAAUE,eAAwB,KAAP,MAAc,MACrGV,EAAG,GACF,EAAG,CAAC,gBAAiB,GAAG,CAE/B,GC3GF,MAAMiD,EAAc,EAEpB,O","sources":["webpack://video-player-demo/./src/views/NativePlayer/canvasPlayer.vue","webpack://video-player-demo/./src/views/NativePlayer/canvasPlayer.vue?882c"],"sourcesContent":["import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, toDisplayString as _toDisplayString, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport _imports_0 from '../../assets/1d13c7cba4e03cea81ba27c397280214.mp4';\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"canvas\", {\n  id: \"canvas\",\n  width: \"600\",\n  height: \"400\",\n  style: {\n    \"border\": \"1px solid blue\"\n  }\n}, null, -1);\nimport { onMounted, reactive } from \"vue\";\nimport { CanvasRecorder, videoScreenshot } from \"@/utils\";\nexport default {\n  __name: 'canvasPlayer',\n  setup(__props) {\n    const videoInfo = reactive({\n      startDraw: false,\n      startVideotape: false,\n      videoEl: null,\n      canvasEl: null,\n      ctx: null,\n      animateId: null,\n      videotape: null\n    });\n    onMounted(() => {\n      videoInfo.videoEl = document.getElementById(\"video\");\n      videoInfo.canvasEl = document.getElementById(\"canvas\");\n      videoInfo.ctx = videoInfo.canvasEl.getContext(\"2d\");\n      videoInfo.videotape = new CanvasRecorder({\n        el: \"#canvas\",\n        download: false\n      });\n    });\n    function draw() {\n      if (videoInfo.videoEl.paused || videoInfo.videoEl.ended) return;\n      videoInfo.startDraw = true;\n      const {\n        width,\n        height\n      } = videoInfo.canvasEl;\n      videoInfo.ctx.clearRect(0, 0, width, height);\n      videoInfo.ctx.drawImage(videoInfo.videoEl, 0, 0, width, height);\n      videoInfo.animateId = requestAnimationFrame(draw);\n    }\n    function onPlay() {\n      if (!videoInfo.videoEl.paused) return;\n      videoInfo.videoEl.play();\n      draw();\n    }\n    function onPause() {\n      if (videoInfo.videoEl.paused) return;\n      videoInfo.videoEl.pause();\n      onEnded();\n    }\n    function onEnded() {\n      cancelAnimationFrame(videoInfo.animateId);\n    }\n    function onScreenshot() {\n      if (!videoInfo.startDraw) return;\n      videoScreenshot({\n        download: false,\n        width: 500,\n        height: 300\n      });\n    }\n    function onVideotape() {\n      if (!videoInfo.startDraw) return;\n      console.log(videoInfo.startVideotape, videoInfo.videotape);\n      videoInfo.startVideotape ? videoInfo.videotape.stop() : videoInfo.videotape.start();\n      videoInfo.startVideotape = !videoInfo.startVideotape;\n    }\n    return (_ctx, _cache) => {\n      const _component_el_button = _resolveComponent(\"el-button\");\n      return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"video\", {\n        id: \"video\",\n        src: _imports_0,\n        style: {\n          \"display\": \"none\"\n        },\n        controls: \"\",\n        muted: \"\",\n        onEnded: onEnded\n      }, null, 32), _hoisted_1, _createElementVNode(\"div\", null, [_createVNode(_component_el_button, {\n        onClick: onPlay,\n        type: \"primary\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"播放\")]),\n        _: 1\n      }), _createVNode(_component_el_button, {\n        onClick: onPause,\n        type: \"primary\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"暂停\")]),\n        _: 1\n      }), _createVNode(_component_el_button, {\n        onClick: onScreenshot,\n        disabled: !videoInfo.startDraw,\n        type: \"primary\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(\"截图\")]),\n        _: 1\n      }, 8, [\"disabled\"]), _createVNode(_component_el_button, {\n        onClick: onVideotape,\n        disabled: !videoInfo.startDraw,\n        type: \"primary\"\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString(!videoInfo.startVideotape ? \"录制\" : \"停止\"), 1)]),\n        _: 1\n      }, 8, [\"disabled\"])])], 64);\n    };\n  }\n};","/* unplugin-vue-components disabled */import script from \"./canvasPlayer.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./canvasPlayer.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","_","id","width","height","style","__name","setup","__props","videoInfo","startDraw","startVideotape","videoEl","canvasEl","ctx","animateId","videotape","draw","paused","ended","clearRect","drawImage","requestAnimationFrame","onPlay","play","onPause","pause","onEnded","cancelAnimationFrame","onScreenshot","download","onVideotape","console","log","stop","start","document","getElementById","getContext","el","_ctx","_cache","_component_el_button","src","controls","muted","onClick","type","default","disabled","__exports__"],"sourceRoot":""}